import static org.hamcrest.CoreMatchers.is;

import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;
import java.io.PrintStream;

import org.junit.Assert;
import org.junit.Test;

public class MainTest {

	@Test
	public void 入力例1() throws Exception {
		String input = "50 50 8" + System.lineSeparator() +
				"53201047392344411470438731252072209638476606576022" + System.lineSeparator() +
				"13242641632370617792332244270350675420864470404947" + System.lineSeparator() +
				"76372756316250650550563212732102937351075767336672" + System.lineSeparator() +
				"43391440260272522122049404306241926052045602433410" + System.lineSeparator() +
				"52720091423022222223344046324704721322132522334463" + System.lineSeparator() +
				"61693424425167321660472564434627234092497347246494" + System.lineSeparator() +
				"74134790436364436322363453027722019104342653173246" + System.lineSeparator() +
				"06407501031023661315440613726761261950342364317750" + System.lineSeparator() +
				"32434003036734297520344434846325625906542524345344" + System.lineSeparator() +
				"05729429300314444521730193634776225440322622762751" + System.lineSeparator() +
				"86170432967422452264329256425612350934624120326541" + System.lineSeparator() +
				"26260636676449250472787131576465747405632235055443" + System.lineSeparator() +
				"40432921056447267224144437767405026230355213327648" + System.lineSeparator() +
				"24472704922530039761140156512267320526045880236176" + System.lineSeparator() +
				"07436062226225795544236739634472433612487916576911" + System.lineSeparator() +
				"55028479331202644253542466261627757154341742036422" + System.lineSeparator() +
				"44736123293411696555237251437134202024002321292635" + System.lineSeparator() +
				"81006264110473511002519270476632234036184209203337" + System.lineSeparator() +
				"34270476462376904464776536713540006776077721473323" + System.lineSeparator() +
				"32686034469090324371414045247233600414023574431213" + System.lineSeparator() +
				"04080796152524541314625733207636637252102345120474" + System.lineSeparator() +
				"36904177763204264504704640313204912205748211284652" + System.lineSeparator() +
				"57646677253297155293792204031260531495473582235447" + System.lineSeparator() +
				"61433022620013614311260112334301203542233443703533" + System.lineSeparator() +
				"26244220666366257106223555253272744437143551534343" + System.lineSeparator() +
				"72304587152225442705443405915460720321040950035230" + System.lineSeparator() +
				"47266334792647716333950266050273713405293544063606" + System.lineSeparator() +
				"42436560231720147179723145056172462274137306344833" + System.lineSeparator() +
				"67443441401341276340150714410757027270244643654052" + System.lineSeparator() +
				"40404753669203250556387534301404004772563702525335" + System.lineSeparator() +
				"33666140790372604312034023231462405523170203279455" + System.lineSeparator() +
				"28102241646055944326071031547720270757259214611268" + System.lineSeparator() +
				"87746061343006140377547262199332060353244672704332" + System.lineSeparator() +
				"41225292920224383122136357428437525343572422270572" + System.lineSeparator() +
				"92160034046626479600394426924399953726374944127112" + System.lineSeparator() +
				"34214633560182413271544514253244940522222796462242" + System.lineSeparator() +
				"90062659764619121220592222437422113522730203122504" + System.lineSeparator() +
				"62132594362434364325233673235334175411672571335787" + System.lineSeparator() +
				"73620117121304602302723930343349513021441324772513" + System.lineSeparator() +
				"17763541417154976777536460213763760329204066378655" + System.lineSeparator() +
				"63263664266374779346744404484544692004111522323332" + System.lineSeparator() +
				"44632343821194331534223464082067723522091642446477" + System.lineSeparator() +
				"19604176094424473236373041633400242226774002570136" + System.lineSeparator() +
				"26233643026251007443132567680196513234006280452006" + System.lineSeparator() +
				"56654403268971142737776260023025532206663443245553" + System.lineSeparator() +
				"03675233864254722764052295365207973334724257032549" + System.lineSeparator() +
				"26647441241535162193323334617330476964344433334454" + System.lineSeparator() +
				"72463395769420225214343614245237240974142331159757" + System.lineSeparator() +
				"14226384625321023247202066906229042200415265466217" + System.lineSeparator() +
				"22420733370592047743255351070026772752224341534396";
		String output = "2" + System.lineSeparator() +
				"1 1" + System.lineSeparator() +
				"2 1" + System.lineSeparator() +
				"1 2" + System.lineSeparator() +
				"1 3" + System.lineSeparator() +
				"2 3" + System.lineSeparator() +
				"3 3" + System.lineSeparator() +
				"4 3" + System.lineSeparator() +
				"4 2" + System.lineSeparator() +
				"5 5" + System.lineSeparator() +
				"6 5" + System.lineSeparator() +
				"7 5" + System.lineSeparator() +
				"8 5" + System.lineSeparator() +
				"9 5" + System.lineSeparator() +
				"10 5" + System.lineSeparator() +
				"11 5" + System.lineSeparator() +
				"12 5";

		assertIO(input, output);
	}

	private void assertIO(String input, String output) throws Exception {
		ByteArrayInputStream in = new ByteArrayInputStream(input.getBytes());
		System.setIn(in);

		ByteArrayOutputStream out = new ByteArrayOutputStream();
		System.setOut(new PrintStream(out));

		Main.main(new String[0]);

		Assert.assertThat(out.toString(), is(output + System.lineSeparator()));
	}
}
